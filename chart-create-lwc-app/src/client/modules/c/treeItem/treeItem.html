<!--
  Copyright (c) 2019, salesforce.com, inc.
  All rights reserved.
  SPDX-License-Identifier: MIT
  For full license text, see the LICENSE file in the repo root or https://opensource.org/licenses/MIT
 -->
<template>
    <template if:true={isRoot}>
        <template for:each={children} for:item="item" for:index="index">
            <template if:true={item.node.isLeaf}>
                <c-tree-item role="treeitem" data-key={item.node.key} key={item.node.key} node-key={item.node.key}
                    aria-selected={item.selected} aria-level={item.node.level} aria-disabled={item.node.isDisabled}
                    label={item.node.label} href={item.node.href} metatext={item.node.metatext}
                    node-ref={item.node.nodeRef} is-expanded={item.node.isExpanded} is-disabled={item.node.isDisabled}
                    focused-child={item.node.focusedChild} nodename={item.node.name} is-leaf={item.node.isLeaf}
                    child-items={item.node.children}>
                </c-tree-item>
            </template>
<template if:false={item.node.isLeaf}>
                <c-tree-item role="treeitem" data-key={item.node.key} key={item.node.key} node-key={item.node.key}
                    aria-selected={item.selected} aria-level={item.node.level} label={item.node.label}
                    href={item.node.href} metatext={item.node.metatext} node-ref={item.node.nodeRef}
                    is-expanded={item.node.isExpanded} is-disabled={item.node.isDisabled}
                    focused-child={item.node.focusedChild} nodename={item.node.name} is-leaf={item.node.isLeaf}
                    child-items={item.node.children} aria-label={item.node.label} aria-expanded={item.node.strexpanded}
                    aria-disabled={item.node.isDisabled}>
                </c-tree-item>
            </template>
</template>
</template>
<template if:false={isRoot}>
        <div class="slds-tree__item dcx-tree__item" onclick={handleClick}>
            <button type="button" class={computedButtonClass} tabindex="-1" aria-hidden="true" title={buttonLabel}>
                <span style="border: solid red 1px;">
                    <c-primitive-icon icon-name={computedIconName} variant="bare"
                        svg-class="slds-button__icon slds-button__icon_small">
                    </c-primitive-icon>
                </span>
                <span class="slds-assistive-text"> {buttonLabel} </span>
            </button>
            <span class="slds-has-flexi-truncate" onclick={lineModal}>
                <template if:true={isDisabled}>
                    <span class="slds-tree__item-label slds-truncate" title={label}>{label}</span>
                    <template if:true={metatext}>
                        <span class="slds-tree__item-meta slds-truncate" title={metatext}>
                            <span class="slds-assistive-text">:</span>{metatext} </span>
                    </template>
</template>
<template if:false={isDisabled}>
                    <template if:true={href}>
                        <a class="dcxclick" href={href} tabindex="-1" role="presentation">
                            <span class="slds-tree__item-label slds-truncate" title={label}>{label}</span>
                            <template if:true={metatext}>
                                <span class="slds-tree__item-meta slds-truncate" title={metatext}>
                                    <span class="slds-assistive-text">:</span>{metatext} </span>
                            </template>
</a>
</template>
<template if:false={href}>
                        <div class="dcxclick" tabindex="-1" role="presentation">
                            <span class="slds-tree__item-label slds-truncate" title={label}>{label}</span>
                            <template if:true={metatext}>
                                <span class="slds-tree__item-meta slds-truncate" title={metatext}>
                                    <span class="slds-assistive-text">:</span>{metatext} </span>
                            </template>
</div>
</template>
</template>
</span>
<div>
    <section aria-describedby="dialog-body-id-107" aria-label="Dialog Title" class="slds-popover slds-nubbin_left" role="dialog">
        <div class="slds-popover__body" id="dialog-body-id-107">
            <div class="slds-media">
                <div class="slds-media__body">
                    <div>
                        <!-- b1 -->
                        <button class="slds-button slds-button_icon slds-button_icon-small slds-float_right slds-popover__close" title="New dialog" onclick={newHandle}>
                                        <!-- icons -->
                                        <svg class="slds-button__icon" aria-hidden="true">
                                            <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#new"></use>
                                        </svg>
                                        <span class="slds-assistive-text">new</span>
                                    </button>
                    </div>
                    <!-- b2 -->
                    <div>
                        <button class="slds-button slds-button_icon slds-button_icon-small slds-float_right slds-popover__close" title="Edit dialog" onclick={editHandle}>
                                        <!-- icons -->
                                        <svg class="slds-button__icon" aria-hidden="true">
                                            <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#edit"></use>
                                        </svg>
                                        <span class="slds-assistive-text">edit</span>
                                    </button>
                    </div>
                    <!-- b3 -->
                    <div>
                        <button class="slds-button slds-button_icon slds-button_icon-small slds-float_right slds-popover__close" title="Delete dialog" onclick={deleteHandle}>
                                        <!-- icons -->
                                        <svg class="slds-button__icon" aria-hidden="true">
                                            <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#delete"></use>
                                        </svg>
                                        <span class="slds-assistive-text">delete</span>
                                    </button>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>
</div>
<template if:true={showExpanded}>
            <div role="group">
                <template for:each={children} for:item="item">
                    <template if:true={item.node.isLeaf}>
                        <c-tree-item role="treeitem" data-key={item.node.key} key={item.node.key}
                            node-key={item.node.key} aria-selected={item.selected} aria-level={item.node.level}
                            aria-disabled={item.node.isDisabled} label={item.node.label} href={item.node.href}
                            metatext={item.node.metatext} node-ref={item.node.nodeRef}
                            is-expanded={item.node.isExpanded} is-disabled={item.node.isDisabled}
                            focused-child={item.node.focusedChild} nodename={item.node.name} is-leaf={item.node.isLeaf}
                            child-items={item.node.children}>
                        </c-tree-item>
                    </template>
<template if:false={item.node.isLeaf}>
                        <c-tree-item role="treeitem" data-key={item.node.key} key={item.node.key}
                            node-key={item.node.key} aria-selected={item.selected} aria-level={item.node.level}
                            aria-disabled={item.node.isDisabled} label={item.node.label} href={item.node.href}
                            metatext={item.node.metatext} node-ref={item.node.nodeRef}
                            is-expanded={item.node.isExpanded} is-disabled={item.node.isDisabled}
                            focused-child={item.node.focusedChild} nodename={item.node.name} is-leaf={item.node.isLeaf}
                            child-items={item.node.children} aria-label={item.node.label}
                            aria-expanded={item.node.strexpanded}>
                        </c-tree-item>
                    </template>
</template>
</div>
</template>
</template>
</template>